<!DOCTYPE html>
<html lang="el">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ανάθεση Θέματος - Topic Assignment</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="../css/TeacherAssignTopic.css">
</head>
<body>

<div class="container-fluid">
  <div class="row flex-nowrap">
    <!-- Sidebar -->
    <div class="col-auto col-md-3 col-xl-2 px-sm-2 px-0 sidebar collapse d-md-block" id="sidebarMenu">
      <div class="sidebar-container">
        
        <!-- Profile pic -->
        <img src="../icons/account.png" alt="Profile" class="profile-avatar" onclick="window.location.href='profile.html'">
        
        <!-- User name link -->
        <div class="user-name">
          Βαλια Παναγοπουλου
        </div>
        
        <!-- Name separator -->
        <div class="name-separator"></div>

        <ul class="nav nav-pills flex-column mb-auto w-100">
          <li class="nav-item nav-spacing">
            <a href="TeacherDashboard.html">
              <img src="../icons/menu.png" alt="Dashboard" class="nav-icon">
              Dashboard
            </a>
          </li>
          <li class="nav-spacing">
            <a href="TeacherStats.html">
              <img src="../icons/stats.png" alt="Statistics" class="nav-icon">
              Στατιστικα
            </a>
          </li>
          <li class="nav-spacing">
            <a href="TeacherCreateThesis.html">
              <img src="../icons/file.png" alt="Thesis Topics" class="nav-icon">
              Θεματα ΔΕ
            </a>
          </li>
          <li class="nav-spacing">
            <a href="TeacherThesisList.html">
              <img src="../list.png" alt="Thesis List" class="nav-icon">
              Λιστα ΔΕ
            </a>
          </li>
          <li class="nav-spacing">
            <a href="TeacherNotes.html">
              <img src="../icons/wirte.png" alt="Notes" class="nav-icon">
              Σημειωσεις
            </a>
          </li>
          <li class="nav-spacing">
            <a href="TeacherAssignTopic.html" class="active">
              <img src="../icons/invitation.png" alt="Assign Topic" class="nav-icon">
              Αναθεση Θεματος
            </a>
          </li>
          <li class="nav-spacing">
            <a href="TeacherInvites.html">
              <img src="../icons/invitation.png" alt="Invitations" class="nav-icon">
              Προσκλησεις
            </a>
          </li>
          
          <div class="nav-separator"></div>
          
          <li class="nav-spacing">
            <a href="settings.html">
              <img src="../icons/setting.png" alt="Settings" class="nav-icon">
              Ρυθμισεις
            </a>
          </li>
          <li class="nav-spacing">
            <a href="../login_page.html" class="logout">
              <img src="../icons/logout.png" alt="Logout" class="nav-icon">
              Αποσυνδεση
            </a>
          </li>
        </ul>
      </div>
    </div>

    <!-- Main Content -->
    <div class="col py-3">
      <!-- Mobile toggle button -->
      <button class="mobile-menu-btn d-md-none" type="button" data-bs-toggle="collapse" data-bs-target="#sidebarMenu">
        <i class="fas fa-bars"></i> Μενού
      </button>

      <!-- Topic Assignment Content -->
      <div class="container">
        <header>
            <h1>Ανάθεση Θέματος</h1>
        </header>
        <hr class="hr">

        <!-- Assignment Form -->
        <div class="assignment-section">
            <h2>Ανάθεση Θέματος σε Φοιτητή</h2>
            <div class="assignment-form">
                <div class="form-row">
                    <div class="form-group">
                        <label for="student-search">Αναζήτηση Φοιτητή:</label>
                        <div class="search-container">
                            <input type="text" id="student-search" placeholder="Εισάγετε ΑΜ ή ονοματεπώνυμο φοιτητή...">
                            <button class="btn-search" onclick="searchStudent()">
                                <i class="fas fa-search"></i>
                            </button>
                        </div>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="topic-select">Επιλογή Θέματος:</label>
                        <select id="topic-select">
                            <option value="">Επιλέξτε θέμα...</option>
                            <option value="1">Ανάπτυξη Web Εφαρμογής για Διαχείριση Διπλωματικών</option>
                            <option value="2">Μηχανική Μάθηση για Προγνωστικά Μοντέλα</option>
                            <option value="3">Ανάλυση Δεδομένων με Python</option>
                            <option value="4">Κυβερνοασφάλεια σε IoT Συσκευές</option>
                            <option value="5">Blockchain Τεχνολογίες</option>
                        </select>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="assignment-notes">Σημειώσεις Ανάθεσης:</label>
                        <textarea id="assignment-notes" rows="4" placeholder="Προαιρετικές σημειώσεις για την ανάθεση..."></textarea>
                    </div>
                </div>

                <div class="form-actions">
                    <button class="btn-assign" onclick="assignTopic()">
                        <i class="fas fa-user-plus"></i> Ανάθεση Θέματος
                    </button>
                    <button class="btn-cancel" onclick="cancelAssignment()">
                        <i class="fas fa-times"></i> Ακύρωση
                    </button>
                </div>
            </div>
        </div>

        <!-- Student Search Results -->
        <div class="search-results-section" id="search-results" style="display: none;">
            <h2>Αποτελέσματα Αναζήτησης</h2>
            <div class="student-list" id="student-list">
                <!-- Student results will be displayed here -->
            </div>
        </div>

        <!-- Recent Assignments -->
        <div class="recent-assignments-section">
            <h2>Πρόσφατες Αναθέσεις</h2>
            <div class="assignments-list" id="assignments-list">
                <!-- Recent assignments will be displayed here -->
            </div>
        </div>
      </div>
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script>
  // Sample data
  let students = [
    { id: 1, am: "2021001", name: "Μαρία Παπαδοπούλου", email: "maria.papadopoulou@example.com" },
    { id: 2, am: "2021002", name: "Γιώργος Κωνσταντίνου", email: "giorgos.konstantinou@example.com" },
    { id: 3, am: "2021003", name: "Ελένη Δημητρίου", email: "eleni.dimitriou@example.com" },
    { id: 4, am: "2021004", name: "Νίκος Αλεξίου", email: "nikos.alexiou@example.com" },
    { id: 5, am: "2021005", name: "Αννα Μιχαηλίδου", email: "anna.michailidou@example.com" }
  ];

  let topics = [
    { id: 1, title: "Ανάπτυξη Web Εφαρμογής για Διαχείριση Διπλωματικών", status: "available" },
    { id: 2, title: "Μηχανική Μάθηση για Προγνωστικά Μοντέλα", status: "available" },
    { id: 3, title: "Ανάλυση Δεδομένων με Python", status: "available" },
    { id: 4, title: "Κυβερνοασφάλεια σε IoT Συσκευές", status: "available" },
    { id: 5, title: "Blockchain Τεχνολογίες", status: "available" }
  ];

  let recentAssignments = [
    {
      id: 1,
      student: "Μαρία Παπαδοπούλου",
      topic: "Ανάπτυξη Web Εφαρμογής για Διαχείριση Διπλωματικών",
      date: "2024-01-15",
      status: "pending"
    },
    {
      id: 2,
      student: "Γιώργος Κωνσταντίνου",
      topic: "Μηχανική Μάθηση για Προγνωστικά Μοντέλα",
      date: "2024-01-10",
      status: "confirmed"
    }
  ];

  // Load page data
  document.addEventListener('DOMContentLoaded', function() {
    loadRecentAssignments();
    
    // Mobile menu toggle
    const mobileMenuBtn = document.querySelector('.mobile-menu-btn');
    const sidebar = document.querySelector('.sidebar');
    
    if (mobileMenuBtn) {
      mobileMenuBtn.addEventListener('click', function() {
        sidebar.classList.toggle('show');
      });
    }

    // Add event listener for student search
    document.getElementById('student-search').addEventListener('keyup', function(e) {
      if (e.key === 'Enter') {
        searchStudent();
      }
    });
  });

  function searchStudent() {
    const searchTerm = document.getElementById('student-search').value.trim();
    const searchResults = document.getElementById('search-results');
    const studentList = document.getElementById('student-list');

    if (!searchTerm) {
      searchResults.style.display = 'none';
      return;
    }

    const filteredStudents = students.filter(student => 
      student.am.toLowerCase().includes(searchTerm.toLowerCase()) ||
      student.name.toLowerCase().includes(searchTerm.toLowerCase()) ||
      student.email.toLowerCase().includes(searchTerm.toLowerCase())
    );

    if (filteredStudents.length === 0) {
      studentList.innerHTML = '<div class="no-results">Δεν βρέθηκαν φοιτητές.</div>';
    } else {
      studentList.innerHTML = filteredStudents.map(student => `
        <div class="student-card" onclick="selectStudent('${student.am}', '${student.name}')">
          <div class="student-info">
            <h4>${student.name}</h4>
            <p><strong>ΑΜ:</strong> ${student.am}</p>
            <p><strong>Email:</strong> ${student.email}</p>
          </div>
          <div class="student-action">
            <button class="btn-select">
              <i class="fas fa-check"></i> Επιλογή
            </button>
          </div>
        </div>
      `).join('');
    }

    searchResults.style.display = 'block';
  }

  function selectStudent(am, name) {
    document.getElementById('student-search').value = `${name} (${am})`;
    document.getElementById('search-results').style.display = 'none';
  }

  function assignTopic() {
    const studentSearch = document.getElementById('student-search').value.trim();
    const topicSelect = document.getElementById('topic-select').value;
    const notes = document.getElementById('assignment-notes').value.trim();

    if (!studentSearch || !topicSelect) {
      showNotification('Παρακαλώ συμπληρώστε όλα τα υποχρεωτικά πεδία.', 'error');
      return;
    }

    const selectedTopic = topics.find(t => t.id == topicSelect);
    
    // Create new assignment
    const newAssignment = {
      id: Date.now(),
      student: studentSearch,
      topic: selectedTopic.title,
      date: new Date().toISOString().split('T')[0],
      status: 'pending',
      notes: notes
    };

    recentAssignments.unshift(newAssignment);
    loadRecentAssignments();
    
    // Clear form
    document.getElementById('student-search').value = '';
    document.getElementById('topic-select').value = '';
    document.getElementById('assignment-notes').value = '';
    
    showNotification('Η ανάθεση έγινε επιτυχώς! Το θέμα κατοχυρώνεται προσωρινά.', 'success');
  }

  function cancelAssignment() {
    document.getElementById('student-search').value = '';
    document.getElementById('topic-select').value = '';
    document.getElementById('assignment-notes').value = '';
    document.getElementById('search-results').style.display = 'none';
  }

  function loadRecentAssignments() {
    const assignmentsList = document.getElementById('assignments-list');
    
    if (recentAssignments.length === 0) {
      assignmentsList.innerHTML = '<div class="no-assignments">Δεν υπάρχουν πρόσφατες αναθέσεις.</div>';
      return;
    }

    assignmentsList.innerHTML = recentAssignments.map(assignment => `
      <div class="assignment-card">
        <div class="assignment-header">
          <h4>${assignment.topic}</h4>
          <span class="status-badge ${assignment.status}">${getStatusText(assignment.status)}</span>
        </div>
        <div class="assignment-details">
          <p><strong>Φοιτητής:</strong> ${assignment.student}</p>
          <p><strong>Ημερομηνία:</strong> ${formatDate(assignment.date)}</p>
          ${assignment.notes ? `<p><strong>Σημειώσεις:</strong> ${assignment.notes}</p>` : ''}
        </div>
        <div class="assignment-actions">
          <button class="btn-revoke" onclick="revokeAssignment(${assignment.id})">
            <i class="fas fa-undo"></i> Ανάκληση
          </button>
        </div>
      </div>
    `).join('');
  }

  function revokeAssignment(id) {
    if (confirm('Είστε σίγουροι ότι θέλετε να αναιρέσετε αυτή την ανάθεση;')) {
      recentAssignments = recentAssignments.filter(assignment => assignment.id !== id);
      loadRecentAssignments();
      showNotification('Η ανάθεση αναιρέθηκε επιτυχώς!', 'success');
    }
  }

  function getStatusText(status) {
    const statuses = {
      'pending': 'Προσωρινή',
      'confirmed': 'Οριστικοποιημένη',
      'revoked': 'Αναιρεμένη'
    };
    return statuses[status] || status;
  }

  function formatDate(dateString) {
    const date = new Date(dateString);
    return date.toLocaleDateString('el-GR');
  }

  function showNotification(message, type) {
    const notification = document.createElement('div');
    notification.className = `notification ${type}`;
    notification.textContent = message;
    document.body.appendChild(notification);

    setTimeout(() => {
      notification.remove();
    }, 3000);
  }
</script>
</body>
</html>
